<!-- <html>
<head>
    <title>My_Order</title>
</head>
<body>
    <h2>Orders</h2>
    <p><strong>User:</strong>{{user.username}} (ID:{{user.id}})</p>
    {%if orders|length == 0%}
        <p>You have not placed any orders yet.</p>
    {%else%}
        {% for order in orders %}
            <section>
                <hr>
                    <h3>Order #{{ order.id }}</h3>
                    <p><strong>Status:</strong> {{ order.payment_status }}</p>
                    {% if order.payment_status == "PENDING" %}
                        <a href="{% url 'product:payu_payment' order.id %}"
                            class="btn btn-warning">
                             Pay Now
                        </a>

                    {% elif order.payment_status == "FAILED" %}
                        <a href="{% url 'product:payu_payment' order.id %}"
                        class="btn btn-danger">
                            Retry Payment
                        </a>

                    {% elif order.payment_status == "SUCCESS" %}
                        <span class="btn btn-success disabled">
                            Paid
                        </span>
                    {% endif %}

                    <p><strong>Product:</strong> {{ order.product }}</p>
                    <p><strong>Quantity:</strong> {{ order.quantity }}</p>
                    <p><strong>Amount:</strong> ₹{{ order.amount }}</p>
                    <p><strong>Delivery Date:</strong> {{ order.delivery_date }}</p>
                    <p><strong>Order Created:</strong> {{ order.created_at }}</p>
                    <p><strong>Message:</strong> {{ order.message }}</p>        
            </section>

        {% endfor %}

    {% endif %}
</html> -->


<nav class="navbar navbar-expand-lg bg-light shadow-sm">
    <div class="container">
        <ul class="navbar-nav ms-auto">
            
            <li class="nav-item"><a class="nav-link" href="{% url 'product:home' %}">Home</a></li>
            <li class="nav-item"><span class="nav-link fw-bold text-dark">Welcome, {{user.username}} </span></li> 
        </ul>
    </div>
</nav>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">


<div class="container my-5">
  <div class="row justify-content-center">

    {% for order in orders %}
    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
      <div class="card shadow-sm ">

        <div class="card-body">

          

              
              <div class="d-flex justify-content-between align-items-center mb-2">
                <h6 class="mb-0">Order #{{ order.id }}</h6>
                <hr class="my-3 opacity-100">

                <div class="col-4 text-end">
                {% if order.payment_status == "SUCCESS" %}
                  <span class="badge bg-success">SUCCESS</span>
                {% elif order.payment_status == "PENDING" %}
                  <span class="badge bg-warning text-dark">PENDING</span>
                {% else %}
                  <span class="badge bg-danger">FAILED</span>
                {% endif %}
                </div>
            </div>
              <hr class="my-3">

              <div class="row">

              
               <div class="col-md-8">
              <p class="mb-1"><strong>Product:</strong> {{ order.product.name }}</p>
              <p class="mb-1"><strong>Quantity:</strong> {{ order.quantity }} KG</p>
              <p class="mb-1"><strong>Amount:</strong> ₹{{ order.amount }}</p>

              {% if order.payment_status == "PENDING" %}
                <a href="{% url 'product:payu_payment' order.id %}"
                   class="btn btn-primary btn-sm mt-2">
                  Pay Now
                </a>

              {% elif order.payment_status == "FAILED" %}
                <a href="{% url 'product:payu_payment' order.id %}"
                   class="btn btn-danger btn-sm mt-2">
                  Retry Payment
                </a>

              {% else %}
                <span class="btn btn-success btn-sm mt-2 disabled">
                  Paid
                </span>
              {% endif %}

            </div>

            <div class="col-md-4 text-end d-flex justify-content-end align-items-center">

              <img src="{{ order.product.image.url }}"
                   alt="{{ order.product.name }}"
                   class="img-fluid rounded"
                   style="max-height:120px; object-fit:cover;">
            </div>

          </div>
        </div>
      </div>
    </div>

    {% empty %}
      <p class="text-center text-muted">No orders found.</p>
    {% endfor %}

  </div>
</div>




